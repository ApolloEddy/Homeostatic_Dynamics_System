**[返回目录](../INDEX.md)** | **[返回本章](./README.md)** | **[上一节](./04.md)** | **[下一节](./06.md)**

# 01.5 数学基础
### 5.1 随机微分方程

随机微分方程（Stochastic Differential Equation, SDE）是描述随机过程的数学工具。HDS 的神经递质系统使用 OU 过程建模：

#### 5.1.1 Ornstein-Uhlenbeck 过程

OU 过程是具有均值回归特性的随机过程：

$$
dX_t = \theta(\mu - X_t)dt + \sigma dW_t
$$

其中：
- $\theta$：回归速率（弹性）
- $\mu$：均值（基线）
- $\sigma$：扩散系数（噪声强度）
- $W_t$：维纳过程（布朗运动）

#### 5.1.2 离散化实现

OU 过程的离散化形式（欧拉-丸山方法）：

$$
X_{t+\Delta t} = X_t + \theta(\mu - X_t)\Delta t + \sigma \sqrt{\Delta t} \cdot \epsilon
$$

其中 $\epsilon \sim \mathcal{N}(\mu_{\epsilon}, \sigma_{\epsilon}^{2})$ 是高斯随机变量（分布参数用符号表示）。

### 5.2 稳定性理论

稳定性理论研究系统在扰动下的行为。HDS 通过以下机制保证系统稳定性：

#### 5.2.1 均值回归

OU 过程具有均值回归特性，确保状态不会无限偏离基线：

$$
\lim_{t \to \infty} \mathbb{E}[X_t] = \mu
$$

#### 5.2.2 有界性

通过软饱和和硬截断确保状态有界：

$$
X_t \in [X_{min}, X_{max}]
$$

#### 5.2.3 软饱和

使用 sigmoid 函数实现软饱和：

$$
\mathrm{sat}(x) = \frac{1}{1 + e^{-k_{\mathrm{sat}}(x - x_{\mathrm{mid}})}}
$$

其中 \(k_{\mathrm{sat}}\) 是软饱和陡峭度，\(x_{\mathrm{mid}}\) 是软饱和中点（均为伪变量）。

**参数解释**：
- \(x_{\mathrm{mid}}\)：sigmoid 形软饱和的中点位置（不展示真实数值）

### 5.3 参数优化

参数优化是指寻找最优参数组合的过程。HDS 的参数可以通过以下方法优化：

#### 5.3.1 梯度下降

梯度下降是一种迭代优化算法：

$$
\theta_{t+1} = \theta_t - \alpha \nabla J(\theta_t)
$$

其中 $\alpha$ 是学习率，$J(\theta)$ 是损失函数。

#### 5.3.2 贝叶斯优化

贝叶斯优化适用于黑盒函数优化：

1. 构建代理模型（如高斯过程）
2. 采集函数选择下一个采样点
3. 更新代理模型
4. 重复直到收敛

---

**[返回目录](../INDEX.md)** | **[返回本章](./README.md)** | **[上一节](./04.md)** | **[下一节](./06.md)**
