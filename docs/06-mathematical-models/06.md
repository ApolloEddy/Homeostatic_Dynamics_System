**[返回目录](../INDEX.md)** | **[返回本章](./README.md)** | **[上一节](./05.md)** | **[下一节](./07.md)**

# 06.6 记忆检索
### 6.1 余弦相似度

#### 6.1.1 定义

余弦相似度：

$$
\cos(\mathbf{q}, \mathbf{m}) = \frac{\mathbf{q} \cdot \mathbf{m}}{\|\mathbf{q}\| \|\mathbf{m}\|}
$$

其中：
- $\mathbf{q}$：查询向量
- $\mathbf{m}$：记忆向量

#### 6.1.2 特性

余弦相似度的特性：

- **有界性**：$\cos(\mathbf{q}, \mathbf{m}) \in [S_{\min}, S_{\max}]$
- **对称性**：$\cos(\mathbf{q}, \mathbf{m}) = \cos(\mathbf{m}, \mathbf{q})$
- **归一化不变性**：$\cos(\alpha\mathbf{q}, \beta\mathbf{m}) = \cos(\mathbf{q}, \mathbf{m})$

### 6.2 时间衰减

#### 6.2.1 指数衰减

指数衰减：

$$
w_{decay} = e^{-age/h_{half\_life}}
$$

其中：
- $age$：记忆年龄
- $h_{half\_life}$：半衰期

#### 6.2.2 半衰期

半衰期：

$$
t_{1/2} = h_{half\_life} \cdot \ln(2)
$$

### 6.3 检索分数

#### 6.3.1 基础分数

基础检索分数：

$$
score_{base} = sim \cdot w_{category}
$$

#### 6.3.2 状态匹配分数

状态匹配分数：

$$
score_{state} = w_{state\_bias} \cdot (1 + e^{-age/h_{half\_life}} + |RPE| \cdot w_{rpe})
$$

#### 6.3.3 最终分数

最终检索分数：

$$
score = score_{base} + score_{state}
$$

---

**[返回目录](../INDEX.md)** | **[返回本章](./README.md)** | **[上一节](./05.md)** | **[下一节](./07.md)**
