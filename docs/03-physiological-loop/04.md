**[返回目录](../INDEX.md)** | **[返回本章](./README.md)** | **[上一节](./03.md)** | **[下一节](./05.md)**

# 03.4 刺激输入处理
### 4.1 工程约束

为了避免"爆炸/贴边/长期失真"，必须对刺激做三件事：

1. **归一化**：把各种事件映射到统一尺度（例如 $[-S_{\max}, S_{\max}]$，其中 $S_{\max}$ 为符号化边界）
2. **裁剪/压缩**：建议 $I = \tanh(raw / s)$ 或 winsorize
3. **双时间常数**：短期情绪回落 + 中期心境回落（两套 OU 或 OU+低通）

### 4.2 刺激归一化

#### 4.2.1 归一化策略

HDS 使用以下归一化策略：

$$
I_{normalized} = \tanh\left(\frac{raw}{s_{stimulus}}\right)
$$

其中：
- $raw$：原始刺激值
- $s_{stimulus}$：归一化尺度

**参数解释**：
- $s_{stimulus}$：刺激归一化尺度（不展示真实数值）

#### 4.2.2 刺激限幅

归一化后，对刺激进行限幅：

$$
I_{clamped} = \text{clamp}(I_{normalized}, -I_{max}, I_{max})
$$

其中：
- $I_{max}$：刺激最大幅度

**参数解释**：
- $I_{max}$：刺激最大幅度（不展示真实数值）

### 4.3 感知刺激映射

#### 4.3.1 冒犯性到 NE 的映射

冒犯性（offensiveness）反映用户输入的攻击性程度，映射到去甲肾上腺素（NE）刺激：

$$
I_{\mathrm{NE}} = \alpha_{\mathrm{offense}\rightarrow \mathrm{ne}}\cdot \tanh\left(\frac{o_t - o_{\mathrm{center}}}{s_o}\right)
$$

其中：
- \(o_t\)：冒犯/威胁观测（有界：\([O_{\min},O_{\max}]\)）
- \(o_{\mathrm{center}}\)：冒犯性中心值（伪变量）
- \(s_o\)：冒犯性尺度（伪变量；\(> 0\)）
- \(\alpha_{\mathrm{offense}\rightarrow \mathrm{ne}}\)：映射增益（伪变量；有界）

**参数解释**：
- \(o_{\mathrm{center}}\)：中心值（用于平移输入分布）
- \(s_o\)：尺度（控制压缩前的敏感区间）
- \(\alpha_{\mathrm{offense}\rightarrow \mathrm{ne}}\)：通道增益（控制 NE 受冒犯刺激的强度）

#### 4.3.2 效价到 DA 的映射

效价（valence）反映用户输入的情感倾向，映射到多巴胺（DA）刺激：

$$
I_{\mathrm{DA}} = \alpha_{\mathrm{valence}\rightarrow \mathrm{da}}\cdot v_t
$$

其中：
- \(v_t\)：效价观测（有界：\([V_{\min},V_{\max}]\)）
- \(\alpha_{\mathrm{valence}\rightarrow \mathrm{da}}\)：映射增益（伪变量；有界）

**参数解释**：
- \(\alpha_{\mathrm{valence}\rightarrow \mathrm{da}}\)：控制效价对 DA 通道刺激的贡献

#### 4.3.3 边界设定到 5HT 的映射

边界设定（boundary setting）反映用户是否设定了边界，映射到血清素（5HT）刺激：

$$
I_{5HT} = \begin{cases}
p_{boundary}, & \text{if } isBoundarySetting \\
0, & \text{otherwise}
\end{cases}
$$

其中：
- $isBoundarySetting$：是否边界设定
- $p_{boundary}$：边界设定惩罚（不展示真实数值）

**参数解释**：
- $p_{boundary}$：边界设定惩罚，控制边界设定对 5HT 的影响程度

### 4.4 双时间常数

为了避免情绪过度波动，HDS 使用双时间常数：

#### 4.4.1 短期情绪回落

短期情绪回落使用较大的回归速率 $\theta_{fast}$：

$$
X_{fast}(t+\Delta t) = X_{fast}(t) + \theta_{fast}(\mu - X_{fast}(t))\Delta t + \sigma\sqrt{\Delta t}\,\epsilon_{fast} + I_{stimulus}
$$

**参数解释**：
- $\theta_{fast}$：短期回归速率（不展示真实数值）

#### 4.4.2 中期心境回落

中期心境回落使用较小的回归速率 $\theta_{slow}$：

$$
X_{slow}(t+\Delta t) = X_{slow}(t) + \theta_{slow}(\mu - X_{slow}(t))\Delta t + \sigma\sqrt{\Delta t}\,\epsilon_{slow} + I_{stimulus}
$$

**参数解释**：
- $\theta_{slow}$：中期回归速率（不展示真实数值）

#### 4.4.3 加权组合

最终状态是短期和中期状态的加权组合：

$$
X_t = \eta \cdot X_{\mathrm{fast}}(t) + (1 - \eta)\cdot X_{\mathrm{slow}}(t)
$$

**参数解释**：
- \(\eta\)：短期权重（伪变量；\(\eta \in [0,1]\)）

---

**[返回目录](../INDEX.md)** | **[返回本章](./README.md)** | **[上一节](./03.md)** | **[下一节](./05.md)**
